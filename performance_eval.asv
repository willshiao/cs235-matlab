clear;

% First, read in the data
load('tensor_10.mat')  % X
load('weather_mod.mat')  % weather

% Next, create a full tensor to work with
X_full = full(X);

% Create log-normalized set
X_lnormal = log_normalize(X);
weather_lnormal = log(weather);
R_log = 13;

% Create mm-normalized set
[X_mmnormal, minX, maxX] = mm_normalize(double(X));
X_mmnormal = tensor(X_mmnormal);
[weather_mmnormal, minW, maxW] = mm_normalize(X);
R_mm = 5;

% Apply CMTF on each one and get the best result
[l_Fac, l_out] = run_acmtf(X_lnormal, weather_lnormal, R_log);
[mm_Fac, mm_out] = run_acmtf(X_mmnormal, weather_mmnormal, R_mm);

% Reconstruct target values
[l_Fac, l_out] = run_acmtf(X_lnormal, weather_lnormal, R_
